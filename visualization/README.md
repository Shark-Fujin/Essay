# YOLO姿势标注可视化工具

这个工具用于查看、验证和比较YOLO格式的姿势标注质量。它允许您加载不同模型生成的标注数据，并进行可视化对比分析。

## 功能特点

- 加载和浏览图像和对应的YOLO格式姿势标注
- 同时显示多个模型的标注结果进行对比
- 支持显示/隐藏边界框和关键点
- 支持按文件名搜索图像
- 提供关键点大小调整功能
- 显示标注的详细信息
- 键盘快捷键支持（左/右切换图像，上/下调整关键点大小）

## 安装依赖

```bash
pip install opencv-python numpy pillow ttkthemes
```

## 使用方法

1. 启动可视化工具：

```bash
python annotation_viewer.py
```

2. 点击"浏览..."按钮，选择包含图像的目录。
3. 工具会自动扫描并加载图像，同时寻找相关的标注文件。
4. 在左侧"模型选择"中选择一个或多个模型以查看其标注结果。
5. 使用左右箭头键（或界面上的"上一张"/"下一张"按钮）浏览图像。
6. 使用上下箭头键调整关键点显示大小。

## 标注格式兼容性

本工具支持YOLO格式的姿势标注文件，格式如下：

```
<class_id> <x_center> <y_center> <width> <height> <x1> <y1> <v1> <x2> <y2> <v2> ... <xn> <yn> <vn>
```

其中：
- `class_id` 是类别ID
- `x_center`、`y_center`、`width`、`height` 是归一化的边界框坐标
- `x1`, `y1`, `v1` 等是关键点坐标和可见度值
  - 关键点坐标是归一化的 (0-1)
  - 可见度值: 0=不可见, 1=部分可见, 2=完全可见

## 验证标注质量技巧

1. **结构一致性检查**：比较不同模型的标注，确保关键点位置符合人体结构逻辑
2. **边界框合理性**：检查边界框是否合理包围了人体所有关键点
3. **可见度一致性**：确认关键点可见度标注是否符合图像内容实际情况
4. **识别率**：查看失败图像目录中的图像，分析不同模型的识别能力
5. **对比分析**：使用多模型视图比较不同检测器的优缺点

## 依赖库说明

- OpenCV：图像处理和绘制标注
- NumPy：数据处理
- Pillow：图像显示
- Tkinter：GUI界面
- ttkthemes（可选）：提供更现代的视觉主题

## 故障排除

- **没有找到标注文件**：确保图像和对应的txt标注文件位于相应的目录结构中
- **标注解析错误**：检查标注文件格式是否符合要求（11个关键点，每个3个值）
- **大型数据集加载缓慢**：首次加载可能需要一些时间，特别是处理大量图像时
- **界面显示异常**：
  - 如果使用ttkthemes出现问题，可以将main函数修改为直接使用AnnotationViewer类
  - 某些主题可能与控件不兼容，可以尝试不同的主题或使用默认外观
- **空白视图问题**：
  - 确保选择了至少一个模型
  - 检查选定目录中是否有图像文件
  - 检查标注文件是否存在且格式正确
- **PanedWindow相关错误**：
  - 使用pack_propagate(False)代替paneconfig可能会解决某些兼容性问题
  - 避免不同版本tkinter之间的方法差异，使用更通用的配置方法
- **图像显示错误**：
  - "no default root window"错误通常是由于试图在创建Tk根窗口之前显示图像
  - 确保所有图像处理逻辑都在主窗口初始化之后执行

## 自定义扩展

您可以通过修改代码轻松地扩展此工具：

1. **支持更多的关键点**：修改`YOLOAnnotationConverter`中的默认关键点数
2. **添加新的可视化选项**：在界面中添加更多控制元素
3. **集成其他格式转换器**：添加对不同标注格式的支持
4. **改进用户界面**：
   - 添加更多过滤和排序选项
   - 实现批量操作功能
   - 添加标注编辑功能

## 版本历史

- v1.0.0 - 初始版本，基本可视化功能
- v1.0.1 - 修复tkinter PanedWindow兼容性问题
- v1.0.2 - 改进空图像数组处理和主题应用

希望这个工具能帮助您更好地理解和改进姿势检测模型的性能！ 